{"ast":null,"code":"import{useEffect,useRef}from'react';import io from'socket.io-client';const SOCKET_URL=process.env.REACT_APP_API_URL;export const useSocket=(ticketId,callbacks)=>{const socketRef=useRef(null);useEffect(()=>{if(!ticketId)return;// Connect to socket server\nsocketRef.current=io(SOCKET_URL,{transports:['websocket','polling']});// Join specific ticket room\nsocketRef.current.emit('joinTicketRoom',ticketId);console.log(\"\\u2705 Joined room: ticket_\".concat(ticketId));// Listen for new comments\nif(callbacks!==null&&callbacks!==void 0&&callbacks.onNewComment){socketRef.current.on('newComment',callbacks.onNewComment);}// Listen for status updates\nif(callbacks!==null&&callbacks!==void 0&&callbacks.onStatusUpdate){socketRef.current.on('ticketStatusUpdated',callbacks.onStatusUpdate);}return()=>{var _socketRef$current,_socketRef$current2,_socketRef$current3;(_socketRef$current=socketRef.current)===null||_socketRef$current===void 0?void 0:_socketRef$current.off('newComment');(_socketRef$current2=socketRef.current)===null||_socketRef$current2===void 0?void 0:_socketRef$current2.off('ticketStatusUpdated');(_socketRef$current3=socketRef.current)===null||_socketRef$current3===void 0?void 0:_socketRef$current3.disconnect();};},[ticketId,callbacks]);return socketRef.current;};","map":{"version":3,"names":["useEffect","useRef","io","SOCKET_URL","process","env","REACT_APP_API_URL","useSocket","ticketId","callbacks","socketRef","current","transports","emit","console","log","concat","onNewComment","on","onStatusUpdate","_socketRef$current","_socketRef$current2","_socketRef$current3","off","disconnect"],"sources":["D:/BROTOTYPE/DASHBOARD/frontend/src/hooks/useSocket.ts"],"sourcesContent":["import { useEffect, useRef, useCallback } from 'react';\r\nimport io, { Socket } from 'socket.io-client';\r\nimport { Comment } from '../types';\r\n\r\nconst SOCKET_URL = process.env.REACT_APP_API_URL;\r\n\r\ninterface SocketCallbacks {\r\n  onNewComment?: (comment: Comment) => void;\r\n  onStatusUpdate?: (data: { id: number; status: string }) => void;\r\n}\r\n\r\nexport const useSocket = (ticketId?: string, callbacks?: SocketCallbacks) => {\r\n  const socketRef = useRef<Socket | null>(null);\r\n\r\n  useEffect(() => {\r\n    if (!ticketId) return;\r\n\r\n    // Connect to socket server\r\n    socketRef.current = io(SOCKET_URL, {\r\n      transports: ['websocket', 'polling']\r\n    });\r\n\r\n    // Join specific ticket room\r\n    socketRef.current.emit('joinTicketRoom', ticketId);\r\n    console.log(`âœ… Joined room: ticket_${ticketId}`);\r\n\r\n    // Listen for new comments\r\n    if (callbacks?.onNewComment) {\r\n      socketRef.current.on('newComment', callbacks.onNewComment);\r\n    }\r\n\r\n    // Listen for status updates\r\n    if (callbacks?.onStatusUpdate) {\r\n      socketRef.current.on('ticketStatusUpdated', callbacks.onStatusUpdate);\r\n    }\r\n\r\n    return () => {\r\n      socketRef.current?.off('newComment');\r\n      socketRef.current?.off('ticketStatusUpdated');\r\n      socketRef.current?.disconnect();\r\n    };\r\n  }, [ticketId, callbacks]);\r\n\r\n  return socketRef.current;\r\n};\r\n"],"mappings":"AAAA,OAASA,SAAS,CAAEC,MAAM,KAAqB,OAAO,CACtD,MAAO,CAAAC,EAAE,KAAkB,kBAAkB,CAG7C,KAAM,CAAAC,UAAU,CAAGC,OAAO,CAACC,GAAG,CAACC,iBAAiB,CAOhD,MAAO,MAAM,CAAAC,SAAS,CAAGA,CAACC,QAAiB,CAAEC,SAA2B,GAAK,CAC3E,KAAM,CAAAC,SAAS,CAAGT,MAAM,CAAgB,IAAI,CAAC,CAE7CD,SAAS,CAAC,IAAM,CACd,GAAI,CAACQ,QAAQ,CAAE,OAEf;AACAE,SAAS,CAACC,OAAO,CAAGT,EAAE,CAACC,UAAU,CAAE,CACjCS,UAAU,CAAE,CAAC,WAAW,CAAE,SAAS,CACrC,CAAC,CAAC,CAEF;AACAF,SAAS,CAACC,OAAO,CAACE,IAAI,CAAC,gBAAgB,CAAEL,QAAQ,CAAC,CAClDM,OAAO,CAACC,GAAG,+BAAAC,MAAA,CAA0BR,QAAQ,CAAE,CAAC,CAEhD;AACA,GAAIC,SAAS,SAATA,SAAS,WAATA,SAAS,CAAEQ,YAAY,CAAE,CAC3BP,SAAS,CAACC,OAAO,CAACO,EAAE,CAAC,YAAY,CAAET,SAAS,CAACQ,YAAY,CAAC,CAC5D,CAEA;AACA,GAAIR,SAAS,SAATA,SAAS,WAATA,SAAS,CAAEU,cAAc,CAAE,CAC7BT,SAAS,CAACC,OAAO,CAACO,EAAE,CAAC,qBAAqB,CAAET,SAAS,CAACU,cAAc,CAAC,CACvE,CAEA,MAAO,IAAM,KAAAC,kBAAA,CAAAC,mBAAA,CAAAC,mBAAA,CACX,CAAAF,kBAAA,CAAAV,SAAS,CAACC,OAAO,UAAAS,kBAAA,iBAAjBA,kBAAA,CAAmBG,GAAG,CAAC,YAAY,CAAC,CACpC,CAAAF,mBAAA,CAAAX,SAAS,CAACC,OAAO,UAAAU,mBAAA,iBAAjBA,mBAAA,CAAmBE,GAAG,CAAC,qBAAqB,CAAC,CAC7C,CAAAD,mBAAA,CAAAZ,SAAS,CAACC,OAAO,UAAAW,mBAAA,iBAAjBA,mBAAA,CAAmBE,UAAU,CAAC,CAAC,CACjC,CAAC,CACH,CAAC,CAAE,CAAChB,QAAQ,CAAEC,SAAS,CAAC,CAAC,CAEzB,MAAO,CAAAC,SAAS,CAACC,OAAO,CAC1B,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}