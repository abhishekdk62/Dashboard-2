{"ast":null,"code":"var _s = $RefreshSig$();\nimport { useEffect, useRef } from 'react';\nimport io from 'socket.io-client';\nconst SOCKET_URL = process.env.REACT_APP_API_URL;\nexport const useSocket = (ticketId, callbacks) => {\n  _s();\n  const socketRef = useRef(null);\n  useEffect(() => {\n    if (!ticketId) return;\n\n    // Connect to socket server\n    socketRef.current = io(SOCKET_URL, {\n      transports: ['websocket', 'polling']\n    });\n\n    // Join specific ticket room\n    socketRef.current.emit('joinTicketRoom', ticketId);\n    console.log(`✅ Joined room: ticket_${ticketId}`);\n\n    // Listen for new comments\n    if (callbacks !== null && callbacks !== void 0 && callbacks.onNewComment) {\n      socketRef.current.on('newComment', callbacks.onNewComment);\n    }\n\n    // Listen for status updates\n    if (callbacks !== null && callbacks !== void 0 && callbacks.onStatusUpdate) {\n      socketRef.current.on('ticketStatusUpdated', callbacks.onStatusUpdate);\n    }\n    return () => {\n      var _socketRef$current, _socketRef$current2, _socketRef$current3;\n      (_socketRef$current = socketRef.current) === null || _socketRef$current === void 0 ? void 0 : _socketRef$current.off('newComment');\n      (_socketRef$current2 = socketRef.current) === null || _socketRef$current2 === void 0 ? void 0 : _socketRef$current2.off('ticketStatusUpdated');\n      (_socketRef$current3 = socketRef.current) === null || _socketRef$current3 === void 0 ? void 0 : _socketRef$current3.disconnect();\n    };\n  }, [ticketId, callbacks]);\n  return socketRef.current;\n};\n_s(useSocket, \"8c0rAI93JE8jpOVTnobt43KkFfY=\");","map":{"version":3,"names":["useEffect","useRef","io","SOCKET_URL","process","env","REACT_APP_API_URL","useSocket","ticketId","callbacks","_s","socketRef","current","transports","emit","console","log","onNewComment","on","onStatusUpdate","_socketRef$current","_socketRef$current2","_socketRef$current3","off","disconnect"],"sources":["D:/BROTOTYPE/DASHBOARD/frontend/src/hooks/useSocket.ts"],"sourcesContent":["import { useEffect, useRef, useCallback } from 'react';\r\nimport io, { Socket } from 'socket.io-client';\r\nimport { Comment } from '../types';\r\n\r\nconst SOCKET_URL = process.env.REACT_APP_API_URL;\r\n\r\ninterface SocketCallbacks {\r\n  onNewComment?: (comment: Comment) => void;\r\n  onStatusUpdate?: (data: { id: number; status: string }) => void;\r\n}\r\n\r\nexport const useSocket = (ticketId?: string, callbacks?: SocketCallbacks) => {\r\n  const socketRef = useRef<Socket | null>(null);\r\n\r\n  useEffect(() => {\r\n    if (!ticketId) return;\r\n\r\n    // Connect to socket server\r\n    socketRef.current = io(SOCKET_URL, {\r\n      transports: ['websocket', 'polling']\r\n    });\r\n\r\n    // Join specific ticket room\r\n    socketRef.current.emit('joinTicketRoom', ticketId);\r\n    console.log(`✅ Joined room: ticket_${ticketId}`);\r\n\r\n    // Listen for new comments\r\n    if (callbacks?.onNewComment) {\r\n      socketRef.current.on('newComment', callbacks.onNewComment);\r\n    }\r\n\r\n    // Listen for status updates\r\n    if (callbacks?.onStatusUpdate) {\r\n      socketRef.current.on('ticketStatusUpdated', callbacks.onStatusUpdate);\r\n    }\r\n\r\n    return () => {\r\n      socketRef.current?.off('newComment');\r\n      socketRef.current?.off('ticketStatusUpdated');\r\n      socketRef.current?.disconnect();\r\n    };\r\n  }, [ticketId, callbacks]);\r\n\r\n  return socketRef.current;\r\n};\r\n"],"mappings":";AAAA,SAASA,SAAS,EAAEC,MAAM,QAAqB,OAAO;AACtD,OAAOC,EAAE,MAAkB,kBAAkB;AAG7C,MAAMC,UAAU,GAAGC,OAAO,CAACC,GAAG,CAACC,iBAAiB;AAOhD,OAAO,MAAMC,SAAS,GAAGA,CAACC,QAAiB,EAAEC,SAA2B,KAAK;EAAAC,EAAA;EAC3E,MAAMC,SAAS,GAAGV,MAAM,CAAgB,IAAI,CAAC;EAE7CD,SAAS,CAAC,MAAM;IACd,IAAI,CAACQ,QAAQ,EAAE;;IAEf;IACAG,SAAS,CAACC,OAAO,GAAGV,EAAE,CAACC,UAAU,EAAE;MACjCU,UAAU,EAAE,CAAC,WAAW,EAAE,SAAS;IACrC,CAAC,CAAC;;IAEF;IACAF,SAAS,CAACC,OAAO,CAACE,IAAI,CAAC,gBAAgB,EAAEN,QAAQ,CAAC;IAClDO,OAAO,CAACC,GAAG,CAAC,yBAAyBR,QAAQ,EAAE,CAAC;;IAEhD;IACA,IAAIC,SAAS,aAATA,SAAS,eAATA,SAAS,CAAEQ,YAAY,EAAE;MAC3BN,SAAS,CAACC,OAAO,CAACM,EAAE,CAAC,YAAY,EAAET,SAAS,CAACQ,YAAY,CAAC;IAC5D;;IAEA;IACA,IAAIR,SAAS,aAATA,SAAS,eAATA,SAAS,CAAEU,cAAc,EAAE;MAC7BR,SAAS,CAACC,OAAO,CAACM,EAAE,CAAC,qBAAqB,EAAET,SAAS,CAACU,cAAc,CAAC;IACvE;IAEA,OAAO,MAAM;MAAA,IAAAC,kBAAA,EAAAC,mBAAA,EAAAC,mBAAA;MACX,CAAAF,kBAAA,GAAAT,SAAS,CAACC,OAAO,cAAAQ,kBAAA,uBAAjBA,kBAAA,CAAmBG,GAAG,CAAC,YAAY,CAAC;MACpC,CAAAF,mBAAA,GAAAV,SAAS,CAACC,OAAO,cAAAS,mBAAA,uBAAjBA,mBAAA,CAAmBE,GAAG,CAAC,qBAAqB,CAAC;MAC7C,CAAAD,mBAAA,GAAAX,SAAS,CAACC,OAAO,cAAAU,mBAAA,uBAAjBA,mBAAA,CAAmBE,UAAU,CAAC,CAAC;IACjC,CAAC;EACH,CAAC,EAAE,CAAChB,QAAQ,EAAEC,SAAS,CAAC,CAAC;EAEzB,OAAOE,SAAS,CAACC,OAAO;AAC1B,CAAC;AAACF,EAAA,CAjCWH,SAAS","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}